## Pandas å¿«é€Ÿå¼€å§‹

å®‰è£… pandas ä»¥åŠç›¸å…³ä¾èµ–
> è¯·ç¡®è®¤å·²ç»å®‰è£…äº†xlrd, xlwt, openpyxl è¿™ä¸‰ä¸ªåŒ…

```shell
pip install pandas==1.3.0
pip install xlrd # xlrd ç‰ˆæœ¬ä¸å¾—é«˜äº2.0.0
pip install xlwt 
pip install openpyxl
```

```python
import pandas as pd

pd.__version__  # 1.3.0
```

## åŸºæœ¬çš„æ–‡ä»¶è¯»å–å’Œå†™å…¥

### æ•°æ®è¯»å–

pandasæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼çš„è¯»å–ã€è¿™é‡Œä¸»è¦ä»‹ç»è¯»å–csv, excel, txt æ–‡ä»¶æ ¼å¼ã€å…¶ä½™æ ¼å¼è¯·è‡ªè¡Œæ‰©å±•ã€‚

```python
import pandas as pd

df_csv = pd.read_csv('../data/xhs_chengdu.csv')
print(df_csv.head(10))
# print(df_csv.head(10).to_markdown())
```

```python
import pandas as pd

df_ = pd.read_excel('../data/xhs_chengdu.xlsx')
print(df_.head(10).to_markdown())
```

è¿™é‡Œæœ‰ä¸€äº›å¸¸ç”¨çš„å…¬å…±å‚æ•°ï¼Œheader=Noneè¡¨ç¤ºç¬¬ä¸€è¡Œä¸ä½œä¸ºåˆ—åï¼Œindex_colè¡¨ç¤ºæŠŠæŸä¸€åˆ—æˆ–å‡ åˆ—ä½œä¸ºç´¢å¼•ï¼Œç´¢å¼•çš„å†…å®¹å°†ä¼šåœ¨ç¬¬ä¸‰ç« è¿›è¡Œè¯¦è¿°ï¼Œusecolsè¡¨ç¤ºè¯»å–åˆ—çš„é›†åˆï¼Œé»˜è®¤è¯»å–æ‰€æœ‰çš„åˆ—ï¼Œparse_datesè¡¨ç¤ºéœ€è¦è½¬åŒ–ä¸ºæ—¶é—´çš„åˆ—ï¼Œå…³äºæ—¶é—´åºåˆ—çš„æœ‰å…³å†…å®¹å°†åœ¨ç¬¬åç« è®²è§£ï¼Œnrowsè¡¨ç¤ºè¯»å–çš„æ•°æ®è¡Œæ•°ã€‚ä¸Šé¢è¿™äº›å‚æ•°åœ¨ä¸Šè¿°çš„ä¸‰ä¸ªå‡½æ•°é‡Œéƒ½å¯ä»¥ä½¿ç”¨ã€‚
æ¯”å¦‚:

```python
import pandas as pd

df_ = pd.read_excel('../data/xhs_chengdu.xlsx',header=None) # å¿½ç•¥è¡¨å¤´
# df_ = pd.read_excel('../data/xhs_chengdu.xlsx',usecols=['city', 'title']) # åªè¯»å– col1,col2 åˆ—
# df_ = pd.read_excel('../data/xhs_chengdu.xlsx',parse_dates=['pub_time']) # éœ€è¦è½¬åŒ–ä¸ºæ—¶é—´çš„åˆ—(pub_time)
# df_ = pd.read_excel('../data/xhs_chengdu.xlsx', nrows=2) # åªè¯»å– 2 è¡Œ
print(df_.head(10).to_markdown()) # è¾“å‡ºå‰ 10 è¡Œå¹¶è½¬åŒ–ä¸º markdown è¯­æ³•
```

å¦‚æœæƒ³è¦æŠŠè¡¨æ ¼å¿«é€Ÿè½¬æ¢ä¸ºmarkdownå’Œlatexè¯­è¨€ï¼Œå¯ä»¥ä½¿ç”¨to_markdownå’Œto_latexå‡½æ•°ï¼Œæ­¤å¤„éœ€è¦å®‰è£…tabulateåŒ…ã€‚

```shell
pip install tabulate
```

è¿™é‡Œç¬”è€…æ¯”è¾ƒæå‰å®‰è£…å®Œæ¯•äº†ã€‚

|    | city   |   collects |   comments | pub_time         | title                                    | update_time         | username          |
|---:|:-------|-----------:|-----------:|:-----------------|:-----------------------------------------|:--------------------|:------------------|
|  0 | æˆéƒ½   |        998 |         10 | 2020-06-11 14:26 | æˆéƒ½é‡åº†æ—…æ¸¸æ”»ç•¥ï½œè¶…è¯¦ç»†ï¼Œå‡æœŸå‡ºæ¸¸å¿…å¤‡   | 2021-08-26 16:47:27 | Starman           |
|  1 | æˆéƒ½   |        160 |         57 | 2021-08-11 20:34 | å¤æ—¥å‡ºè¡Œï½œè¶…è¯¦ç»†çš„æˆéƒ½èåˆ›ä¹å›­æ”»ç•¥ï¼     | 2021-08-26 16:47:31 | è”æå¤ªéƒ          |
|  2 | æˆéƒ½   |       2127 |        137 | 2020-06-11 19:49 | æˆéƒ½å¤œå¸‚æœ€å¼ºæ”»ç•¥åˆé›†ï¼Œæ€»æœ‰ä¸€ä¸ªèƒ½æ‰“åŠ¨ä½    | 2021-08-26 16:47:36 | é‡‘å…‹ä¸            |
|  3 | æˆéƒ½   |       2403 |        152 | 2019-08-16 21:49 | äº”ä¸€å°é•¿å‡æ€ä¹ˆèŠ±1500å…ƒç©è½¬é‡åº†å’Œæˆéƒ½ğŸ‘‡   | 2021-08-26 16:47:40 | æ—…æ‹æ‘„å½±å¸ˆå°å‘¨å‘¨  |
|  4 | æˆéƒ½   |        568 |         53 | 2021-07-27 17:21 | é‡åº†æˆéƒ½5å¤©4å¤œä¸€ç«™å¼æ—…æ¸¸æ”»ç•¥ğŸ”¥äººå‡1000   | 2021-08-26 16:47:44 | ä¸çœ çš„å°å—·å¨‡      |
|  5 | æˆéƒ½   |       1302 |         20 | 2021-04-26 12:31 | 2021å¹´æˆéƒ½ç§è—æ”»ç•¥ãŠ™ï¸äº”ä¸€å°é•¿å‡æ—…æ¸¸å¿…çœ‹   | 2021-08-26 16:47:48 | 150æ–¤å°‘å¥³         |
|  6 | æˆéƒ½   |        700 |          7 | 2021-04-25 08:40 | æˆéƒ½ä¸‰å¤©ä¸¤æ™šä¿å§†çº§æ”»ç•¥ğŸ”µäººå‡1000ğŸ’°å¿«æ”¶è— | 2021-08-26 16:47:52 | é›ªçªå°ä»™å¥³        |
|  7 | æˆéƒ½   |        564 |         36 | 2021-03-25 23:04 | æˆéƒ½å¿…å»çš„12ä¸ªæ™¯ç‚¹é—¨ç¥¨æ”»ç•¥ï½             | 2021-08-26 16:47:57 | é›ªçªå°ä»™å¥³        |
|  8 | æˆéƒ½   |       3190 |        122 | 2021-04-21 16:59 | æˆéƒ½æ—…æ¸¸æ”»ç•¥|ç½‘çº¢ç¾é£Ÿé¿å‘|æœ¬åœ°äººæ¨èâ€¼ï¸    | 2021-08-26 16:48:01 | ç ´äº§å…„å¼ŸBrokeBros |
|  9 | æˆéƒ½   |        963 |         39 | 2021-06-11 11:35 | æˆéƒ½æ—…æ¸¸â€¼ï¸æœ¬åœ°äººæ•´ç†ä¸‰å¤©ä¸¤å¤œåƒå–å…¨æ”»ç•¥    | 2021-08-26 16:48:05 | 150æ–¤å°‘å¥³         |

> å¦‚è¡¨æ ¼æ ¼å¼æœ‰é”™ä¹±ã€ç¬”è€…æ¨èä½¿ç”¨ jupyter notebook

```python
import pandas as pd

df_csv = pd.read_table('../data/xhs_chengdu.txt')
print(df_csv.head(5))
```

åœ¨è¯»å–txtæ–‡ä»¶æ—¶ï¼Œç»å¸¸é‡åˆ°åˆ†éš”ç¬¦éç©ºæ ¼çš„æƒ…å†µï¼Œread_table æœ‰ä¸€ä¸ªåˆ†å‰²å‚æ•°sepï¼Œ
å®ƒä½¿å¾—ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰åˆ†å‰²ç¬¦å·ï¼Œè¿›è¡Œtxtæ•°æ®çš„è¯»å–ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„è¯»å–çš„è¡¨ä»¥ abc ä¸ºåˆ†å‰²ï¼š

è¿™é‡Œæœ‰ä¸€ä»½ txt æ–‡ä»¶æ ¼å¼çš„æ•°æ®ã€å®ƒä»¥ abc ä¸ºåˆ†å‰²ç¬¦ï¼š
```text
col1 abc col2
TS abc This is an apple.
GQ abc My name is Bob.
WT abc Well done!
PT abc May I help you?
```


```python
import pandas as pd
df_ = pd.read_table('../data/my_table_special_sep.txt')
```

|    | col1 abc col2            |
|---:|:-------------------------|
|  0 | TS abc This is an apple. |
|  1 | GQ abc My name is Bob.   |
|  2 | WT abc Well done!        |
|  3 | PT abc May I help you?   |

ä¸Šé¢çš„ç»“æœæ˜¾ç„¶ä¸æ˜¯ç†æƒ³çš„ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨sepï¼ŒåŒæ—¶éœ€è¦æŒ‡å®šå¼•æ“ä¸ºpythonï¼š

```python
import pandas as pd
df_ = pd.read_table('../data/my_table_special_sep.txt', sep=' abc ', engine='python')
```

å¾—åˆ°:

|    | col1   | col2              |
|---:|:-------|:------------------|
|  0 | TS     | This is an apple. |
|  1 | GQ     | My name is Bob.   |
|  2 | WT     | Well done!        |
|  3 | PT     | May I help you?   |

> ã€WARNINGã€‘sepæ˜¯æ­£åˆ™å‚æ•°
åœ¨ä½¿ç”¨read_tableçš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œå‚æ•°sepä¸­ä½¿ç”¨çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œå› æ­¤éœ€è¦å¯¹|è¿›è¡Œè½¬ä¹‰å˜æˆ\|ï¼Œå¦åˆ™æ— æ³•è¯»å–åˆ°æ­£ç¡®çš„ç»“æœã€‚æœ‰å…³æ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬å†…å®¹å¯ä»¥å‚è€ƒç¬¬å…«ç« æˆ–è€…å…¶ä»–ç›¸å…³èµ„æ–™ã€‚


### æ•°æ®å†™å…¥
ä¸€èˆ¬åœ¨æ•°æ®å†™å…¥ä¸­ï¼Œæœ€å¸¸ç”¨çš„æ“ä½œæ˜¯æŠŠindexè®¾ç½®ä¸ºFalseï¼Œç‰¹åˆ«å½“ç´¢å¼•æ²¡æœ‰ç‰¹æ®Šæ„ä¹‰çš„æ—¶å€™ï¼Œè¿™æ ·çš„è¡Œä¸ºèƒ½æŠŠç´¢å¼•åœ¨ä¿å­˜çš„æ—¶å€™å»é™¤ã€‚

[æ•°æ®å‡†å¤‡csv](data/æ•°æ®å‡†å¤‡csv.md ':include')

å°†è¯»å–åˆ°çš„ csv æ–‡ä»¶æ•°æ®å†™å…¥åˆ° xlsx æ–‡ä»¶(åä¹‹äº¦ç„¶)
```python
import pandas as pd
df_ = pd.read_excel('../data/xhs_chengdu.xlsx') # å¿½ç•¥è¡¨å¤´
df_.to_excel('../data/my_csv_saved.xlsx', index=False)
```

## å¸¸ç”¨æ–¹æ³•å’ŒåŸºæœ¬æ•°æ®ç»“æ„
- `pd.Series` æ–¹æ³•: ä¸€ç»´çš„è¡Œæ•°æ®ç»“æ„
- `pd.DataFrame` æ–¹æ³•: äºŒç»´çš„è¡¨æ ¼ç»“æ„(å¸¸ç”¨äºè¯»å†™è½¬æ¢)

æ„å»º Series
```python
import pandas as pd
s = pd.Series(data = [100, 'a', {'dic1':5}],
              index = pd.Index(['id1', 20, 'third'], name='my_idx'),
              dtype = 'object',
              name = 'my_name')

```
objectä»£è¡¨äº†ä¸€ç§æ··åˆç±»å‹ï¼Œæ­£å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­å­˜å‚¨äº†æ•´æ•°ã€å­—ç¬¦ä¸²ä»¥åŠPythonçš„å­—å…¸æ•°æ®ç»“æ„ã€‚æ­¤å¤–ï¼Œç›®å‰pandasæŠŠçº¯å­—ç¬¦ä¸²åºåˆ—ä¹Ÿé»˜è®¤è®¤ä¸ºæ˜¯ä¸€ç§objectç±»å‹çš„åºåˆ—

DataFrameåœ¨Seriesçš„åŸºç¡€ä¸Šå¢åŠ äº†åˆ—ç´¢å¼•ï¼Œä¸€ä¸ªæ•°æ®æ¡†å¯ä»¥ç”±äºŒç»´çš„dataä¸è¡Œåˆ—ç´¢å¼•æ¥æ„é€ 
```python
import pandas as pd
data = [[1, 'a', 1.2], [2, 'b', 2.2], [3, 'c', 3.2]]
df = pd.DataFrame(data = data,
                  index = ['row_%d'%i for i in range(3)],
                  columns=['col_0', 'col_1', 'col_2'])
```

## ç¼ºå¤±å€¼çš„å¤„ç†

## pandas è¿›é˜¶ä½¿ç”¨

## æ–‡ä»¶è½¬å‚¨(ä¸æ•°æ®åº“äº¤äº’)